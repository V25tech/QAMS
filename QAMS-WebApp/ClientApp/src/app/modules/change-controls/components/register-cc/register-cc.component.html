<div class="d-flex justify-content-between align-items-center bg-white shadow-dark px-3">
    <a class="me-2" (click)="backToCCClick()">
        <i class="fa-solid fa-arrow-left back-icon m-l-3"></i></a>
    <h4 class="page-title flex-grow-1 labelStyles">Change Control Login New Initiations</h4>
</div>

<div class="px-4 py-4">
    <form [formGroup]="mainForm" (ngSubmit)="onSubmit()">
        <!-- Request Details-->
        <div formGroupName="requestDetails" class="p-3 bg-white shadow-dark rounded-2 mb-3">
            <h5 class="page-card-title border-bottom">Request Details</h5>
            <div class="p-3 row">
                <div class="col-lg-12">
                    <div class="form-group row">
                        <label for="Reference " class="col-sm-12 col-md-3 col-form-label">Reference </label>

                        <div class="col-md-6 d-flex radio-styles">
                            <div class=""><input type="radio" formControlName="reference" class="form-check-input external-radio-btn" id="External" name="reference" value="External">
                                <label class="p-2" for="External">External</label>
                            </div>
                            <div class="rd-styles ms-4"> <input type="radio" formControlName="reference" class="form-check-input internal-radio-btn" id="Internal" name="reference" value="Internal">
                                <label class="p-2" for="Internal">Internal</label>
                            </div>
                        </div>
                    </div>
                    <div class="form-group row" *ngIf="mainForm.get('requestDetails').get('reference').value === 'Internal'">
                        <label for="Internal Reference" class=" col-sm-12 col-md-3 col-form-label">Quality Events</label>
                        <div class="col-md-6 drp-styles ">
                            <select formControlName="qualityEvents" name="status" class="form-select">
                                <option *ngFor="let selectedInternalDetails of internalDetails" [value]="selectedInternalDetails.code">
                                    {{selectedInternalDetails.name}}
                                </option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="col-lg-12" *ngIf="mainForm.get('requestDetails').get('reference').value === 'External'">
                    <div class="form-group row">
                        <label for="External Reference" class="col-md-3 col-sm-12 col-form-label">External Reference</label>
                        <div class="col-md-6  ">
                            <textarea formControlName="externalReference" rows="3" class="form-control" name="comment" form="usrform"
                                placeholder="Enter text here..."></textarea>
                        </div>
                    </div>
                </div>

                <div class="col-lg-12">
                    <div class="form-group row">
                        <label for="Initiating Department" class="col-md-3 col-sm-12 col-form-label">Initiating Department</label>
                        <div class="col-md-6 ">
                            <input type="text" formControlName="initiatingDepartment" class="form-control input-width" id="Initiating Department"
                                name="Initiating Department"  placeholder="Enter Initiating Department here" />
                        </div>
                    </div>
                </div>
                <div class="col-lg-12">
                    <div class="form-group row">
                        <label for="Type of Change " class="col-md-3 col-sm-12 col-form-label">Type of Change</label>

                        <div class="col-md-6 d-flex radio-styles">
                            <div class=""><input type="radio" formControlName="typeOfChange" id="Permanent" name="typeOfChange" value="Permanent" checked
                                class="form-check-input external-radio-btn">
                                <label class="p-2" for="Permanent">Permanent</label>
                            </div>
                            <div class="rd-styles ms-4"> <input type="radio" formControlName="typeOfChange" id="Temporary" name="typeOfChange" value="Temporary"
                                class="form-check-input external-radio-btn">
                                <label class="p-2" for="Temporary">Temporary</label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-12" *ngIf="mainForm.get('requestDetails').get('typeOfChange').value === 'Temporary'">
                    <div class="form-group row">
                        <label for="Batch no" class="col-md-3 col-sm-12 col-form-label">
                            Batch No./Lot No.</label>
                            <div class="col-md-6 ">
                            <select formControlName="batchNoLotNo" name="status" class="form-select">
                                <option *ngFor="let selectedBatchDetails of batchDetails" [value]="selectedBatchDetails.code">
                                    {{selectedBatchDetails.name}}
                                </option>
                            </select>
                            </div>
                    </div>
                </div>
                <div class="col-lg-12" *ngIf="mainForm.get('requestDetails').get('typeOfChange').value === 'Temporary'">
                    <div class="form-group row">
                        <label for="Batch no" class="col-md-3 col-sm-12 col-form-label">
                            Batch No./Lot Details.</label>
                            <div class="col-md-6  ">
                                <textarea formControlName="batchNoLotDetails" rows="3" class="form-control" name="comment"
                                    placeholder="Enter text here..."></textarea>
                            </div>
                    </div>
                </div>
                <div class="col-lg-12">
                    <div class="form-group row">
                        <label for="Date of Initiation" class="col-md-3 col-sm-12 col-form-label">Date of Initiation</label>
                        <div class="col-md-6 ">
                            <input type="date" formControlName="dateofInitiation" class="form-control date-styles" id="Date of Initiation"
                                name="Date of Initiation" placeholder="19/03/24" />
                        </div>
                    </div>
                </div>
                <div class="col-lg-12">
                    <div class="form-group row">
                        <label for="Target Date of Closure" class="col-md-3 col-sm-12 col-form-label">Target Date of Closure</label>
                        <div class="col-md-6 ">
                            <input type="date" formControlName="targetDateofClosure" class="form-control date-styles" id="Target Date of Closure" name="targetDateofClosure">
                        </div>
                    </div>
                </div>
                <div class="col-lg-12">
                    <div class="form-group row">
                        <label for="Market" class="col-sm-12 col-md-3 col-form-label">Market</label>
                        <div class="col-md-6">
                            
                            <select formControlName="market" name="status" class="form-select">
                                <option *ngFor="let selectedMarketDetails of marketDetails" [value]="selectedMarketDetails.code">
                                    {{selectedMarketDetails.name}} -  {{selectedMarketDetails.code}}
                                </option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="col-lg-12">
                    <div class="form-group row">
                        <label for="Customer" class="col-sm-4 col-md-3 col-form-label">Customer</label>
                        <div class="col-md-6">
                            <select formControlName="customer" name="status" class="form-select">
                                <option *ngFor="let selectedCustomerDetails of customerDetails" [value]="selectedCustomerDetails.code">
                                    {{selectedCustomerDetails.name}}
                                </option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <!-- Change Details-->
        <div formGroupName="changeDetails" class="p-3 bg-white shadow-dark rounded-2 mb-3">
            <h5 class="page-card-title border-bottom">Change Details</h5>
            <div class="p-3 row">
                <div class="col-lg-12">
                    <div class="form-group row">
                        <label for="Changes Related To" class="col-sm-3 col-form-label">Changes Related To</label>
                        <div class="col-md-6">
                            <select formControlName="changesRelatedTo" name="status" class="form-select">
                                <option *ngFor="let selectedChangeDetails of changeDetails" [value]="selectedChangeDetails.code">
                                    {{selectedChangeDetails.name}}
                                </option>
                            </select>
                        
                        </div>
                    </div>
                </div>
                <ng-container *ngIf="mainForm.get('changeDetails').get('changesRelatedTo').value === 'Material'">
                    <div class="material-container">
                        <div class="form-group row">
                            <label for="Material" class="col-sm-3 col-form-label">Material</label>
                            <div class="col-md-6 ">
                                <select formControlName="material" name="status1" class="form-select">
                                    <option *ngFor="let selectedMaterialDetails of materialDetails" [value]="selectedMaterialDetails.code">
                                        {{selectedMaterialDetails.name}}
                                    </option>
                                </select>
                            </div>
                        </div>
                    </div>
                </ng-container>
                <ng-container *ngIf="mainForm.get('changeDetails').get('changesRelatedTo').value === 'Equipment'">
                    <div class="material-container">
                        <div class="form-group row">
                            <label for="Equipment" class="col-sm-3 col-form-label">Equipment</label>
                            <div class="col-md-6 ">
                                <select formControlName="equipment" name="status2" class="form-select">
                                    <option *ngFor="let selectedEquipmentDetails of equipmentDetails" [value]="selectedEquipmentDetails.code">
                                        {{selectedEquipmentDetails.name}}
                                    </option>
                                </select>
                            </div>
                        </div>
                    </div>
                </ng-container>
                <ng-container *ngIf="mainForm.get('changeDetails').get('changesRelatedTo').value === 'Document'">
                    <div class="material-container">
                        <div class="form-group row">
                            <label for="Document" class="col-sm-3 col-form-label">Document</label>
                            <div class="col-md-6 ">
                                <textarea formControlName="document" class="form-control input-width" name="documentDetails"
                                    placeholder="Enter Details">
                                    </textarea>
                            </div>
                        </div>
                    </div>
                </ng-container>
                <ng-container *ngIf="mainForm.get('changeDetails').get('changesRelatedTo').value === 'Facility/Utility'">
                    <div class="material-container">
                        <div class="form-group row">
                            <label for="Facility/Utility" class="col-sm-3 col-form-label">Facility/Utility</label>
                            <div class="col-md-6 ">
                                <textarea formControlName="facilityUtility" class="form-control input-width" name="facilityDetails"
                                    placeholder="Enter Details">
                                    </textarea>
                            </div>
                        </div>
                    </div>
                </ng-container>
                <ng-container *ngIf="mainForm.get('changeDetails').get('changesRelatedTo').value === 'Validation'">
                    <div class="material-container">
                        <div class="form-group row">
                            <label for="Validation" class="col-sm-3 col-form-label">Validation</label>
                            <div class="col-md-6 ">
                                <textarea formControlName="validation" class="form-control input-width" name="validationDetails"
                                    placeholder="Enter Details">
                                    </textarea>
                            </div>
                        </div>
                    </div>
                </ng-container>
                <ng-container *ngIf="mainForm.get('changeDetails').get('changesRelatedTo').value === 'Packing'">
                    <div class="material-container">
                        <div class="form-group row">
                            <label for="Packing" class="col-sm-3 col-form-label">Packing</label>
                            <div class="col-md-6 ">
                                <textarea formControlName="packing" class="form-control input-width" name="packingDetails"
                                    placeholder="Enter Details">
                                    </textarea>
                            </div>
                        </div>
                    </div>
                </ng-container>
                <ng-container *ngIf="mainForm.get('changeDetails').get('changesRelatedTo').value === 'Software'">
                    <div class="material-container">
                        <div class="form-group row">
                            <label for="Software" class="col-sm-3 col-form-label">Software</label>
                            <div class="col-md-6 ">
                                <textarea formControlName="software" class="form-control input-width" name="softwareDetails"
                                    placeholder="Enter Details">
                                </textarea>
                            </div>
                        </div>
                    </div>
                </ng-container>
                <ng-container *ngIf="mainForm.get('changeDetails').get('changesRelatedTo').value === 'Testing'">
                    <div class="material-container">
                        <div class="form-group row">
                            <label for="Testing" class="col-sm-3 col-form-label">Testing</label>
                            <div class="col-md-6 ">
                                <textarea formControlName="testing" class="form-control input-width" name="testingDetails"
                                    placeholder="Enter Details">
                                    </textarea>
                            </div>
                        </div>
                    </div>
                </ng-container>
                <ng-container *ngIf="mainForm.get('changeDetails').get('changesRelatedTo').value === 'Supplier/Service Provider'">
                    <div class="material-container">
                        <div class="form-group row">
                            <label for="Supplier/Service Provider" class="col-sm-3 col-form-label">Supplier/Service
                                Provider</label>
                                <div class="col-md-6 ">
                                    <textarea formControlName="supplierServiceProvider" class="form-control input-width" name="supplierDetails"
                                        placeholder="Enter Details">
                                        </textarea>
                                </div>
                        </div>
                    </div>
                </ng-container>
                <ng-container *ngIf="mainForm.get('changeDetails').get('changesRelatedTo').value === 'Others'">
                    <div class="material-container">
                        <div class="form-group row">
                            <label for="Others" class="col-sm-3 col-form-label">Others</label>
                            <div class="col-md-6 ">
                                <textarea formControlName="others" class="form-control input-width" name="Existing Procedure"
                                    placeholder="Enter Details">
                                    </textarea>
                            </div>
                        </div>
                    </div>
                </ng-container>
                <ng-container *ngIf="mainForm.get('changeDetails').get('changesRelatedTo').value === 'New Product & Existing Product'">
                    <div class="col-lg-12">
                        <div class=" form-group row mb-3">
                            <div class="col-lg-12 d-flex">
                                <label for="Market" class="col-sm-3 col-form-label">Products</label>
                                <div class="col-md-6">
                                    <select formControlName="products"  name="status" class="form-select">
                                        <option *ngFor="let selectedProoductedDetails of productDetails" [value]="selectedProoductedDetails.code">
                                            {{selectedProoductedDetails.name}}
                                        </option>
                                    </select>
                                </div>
                            
                            </div>   
                        </div>
                    </div>
                    <div class="form-group row col-lg-10">
                        <label for="Element Impurities Assesment" class="col-sm-12 col-md-4 col-form-label">Element Impurities Assesment </label>

                        <div class="col-md-6 d-flex radio-styles">
                            <div class=""><input type="radio" formControlName="impurityAssesment" class="form-check-input external-radio-btn" id="yes" name="impurityAssesment" value="yes">
                                <label class="p-2" for="Yes">Yes</label>
                            </div>
                            <div class="rd-styles ms-4"> <input type="radio" formControlName="impurityAssesment" class="form-check-input internal-radio-btn" id="no" name="impurityAssesment" value="no">
                                <label class="p-2" for="No">No</label>
                            </div>
                        </div>
                        <ng-container *ngIf="mainForm.get('changeDetails').get('impurityAssesment').value === 'no'">
                            <div class="form-group row mt-3">
                                <label for="impurityReason" class="col-md-4 col-sm-12 col-form-label">Reason</label>
                                <div class="col-md-6  ">
                                    <textarea formControlName="impurityReason" rows="3" class="form-control" name="impurityReason" form="usrform"
                                        placeholder="Enter text here..."></textarea>
                                </div>
                            </div>
                        
                        </ng-container>
                    </div>

                    <div class="form-group row col-lg-10">
                        <label for="Nitrosamine Impurities Assesment" class="col-sm-12 col-md-4 col-form-label">Nitrosamine Impurities Assesment </label>

                        <div class="col-md-6 d-flex radio-styles">
                            <div class=""><input type="radio" formControlName="nitrosamineAssesment" class="form-check-input external-radio-btn" id="yes" name="nitrosamineAssesment" value="yes">
                                <label class="p-2" for="Yes">Yes</label>
                            </div>
                            <div class="rd-styles ms-4"> <input formControlName="nitrosamineAssesment" type="radio" class="form-check-input internal-radio-btn" id="no" name="nitrosamineAssesment" value="no">
                                <label class="p-2" for="No">No</label>
                            </div>
                        </div>
                        <ng-container *ngIf="mainForm.get('changeDetails').get('nitrosamineAssesment').value === 'no'">
                            <div class="form-group row mt-3">
                                <label for="nitrosamineReason" class="col-md-4 col-sm-12 col-form-label">Reason</label>
                                <div class="col-md-6  ">
                                    <textarea formControlName="nitrosamineReason" rows="3" class="form-control" name="nitrosamineReason" form="usrform"
                                        placeholder="Enter text here..."></textarea>
                                </div>
                            </div>
                        
                        </ng-container>
                    </div>

                    <div class="form-group row col-lg-10">
                        <label for="Genotoxic Impurities Assesment" class="col-sm-12 col-md-4 col-form-label">Genotoxic Impurities Assesment</label>

                        <div class="col-md-6 d-flex radio-styles">
                            <div class=""><input type="radio" formControlName="genotoxicAssesment" class="form-check-input external-radio-btn" id="yes" name="genotoxicAssesment" value="yes">
                                <label class="p-2" for="Yes">Yes</label>
                            </div>
                            <div class="rd-styles ms-4"> <input type="radio" formControlName="genotoxicAssesment" class="form-check-input internal-radio-btn" 
                                id="no" name="genotoxicAssesment" value="no">
                                <label class="p-2" for="No">No</label>
                            </div>
                        </div>
                        <ng-container *ngIf="mainForm.get('changeDetails').get('genotoxicAssesment').value === 'no'">
                            <div class="form-group row mt-3">
                                <label for="genatoxicReason" class="col-md-4 col-sm-12 col-form-label">Reason</label>
                                <div class="col-md-6  ">
                                    <textarea formControlName="genatoxicReason" rows="3" class="form-control" name="genatoxicReason" form="usrform"
                                        placeholder="Enter text here..."></textarea>
                                </div>
                            </div>
                        </ng-container>
                    </div>
                </ng-container>

                <div class="col-lg-12">
                    <div class="form-group row">
                        <label for="Existing Procedure" class="col-md-3 col-sm-12 col-form-label">Existing Procedure</label>
                            <div class="col-md-6 ">
                                <textarea formControlName="existingProcedure" class="form-control input-width" name="Existing Procedure"
                                    placeholder="details">
                                </textarea>
                            </div>
                    </div>
                </div>

                <div class="col-lg-12">
                    <div class="form-group row">
                        <label for="Proposed Change" class="col-md-3 col-sm-12 col-form-label">Proposed Change</label>
                            <div class="col-md-6 ">
                                <textarea formControlName="proposedChange" class="form-control input-width" name="Proposed Change"
                                    placeholder="details">
                                </textarea>
                            </div>  
                    </div>
                </div>

                <div class="col-lg-12">
                    <div class="form-group row">
                        <label for="Justification for Proposed Change "
                            class="col-md-3 col-sm-12 col-form-label">Justification for Proposed Change</label>
                            <div class="col-md-6 ">
                                <textarea formControlName="justificationForProposedChange" class="form-control input-width" name="Justification for Proposed Change"
                                    placeholder="details">
                                </textarea>
                            </div> 
                    
                    </div>
                </div>

            </div>
        </div>

        <!--Impact AssessMent Details-->
        <div formGroupName="impactAssessmentDetails" class="p-3 bg-white shadow-dark rounded-2 mb-3">
            <h5 class="page-card-title border-bottom">Impact Assesessment Details</h5>
            <div class="p-3 row">
                <div class="col-md-12">
                    <div class="form-group row">
                        <label for="Change Impact " class="col-md-4 col-sm-12 col-form-label">
                            Does the Change Impact Product/Material Quality
                        </label>
                        <div class="col-lg-6 d-flex radio-styles ">
                            <div class="form-check ">
                                <input class="form-check-input" formControlName="isChangeImpactProductMaterial" type="radio" id="changeImpactProductMaterialyes" name="isChangeImpactProductMaterial" value="Yes">
                                <label class="form-check-label" for="Yes">Yes</label>
                            </div>
                            <div class="form-check ms-4">
                                <input class="form-check-input" formControlName="isChangeImpactProductMaterial" type="radio" id="changeImpactProductMaterialNo" name="isChangeImpactProductMaterial" value="No">
                                <label class="form-check-label" for="No">No</label>
                            </div>
                            <div class="form-check ms-4">
                                <input class="form-check-input" formControlName="isChangeImpactProductMaterial" type="radio" id="changeImpactProductMaterialnotApplicable" name="isChangeImpactProductMaterial" value="Not Applicable">
                                <label class="form-check-label" for="notApplicable">Not Applicable</label>
                            </div>
                        </div>
                        <ng-container *ngIf="mainForm.get('impactAssessmentDetails').get('isChangeImpactProductMaterial').value == 'Yes'">
                            <div class="form-group row mt-3">
                                <label for="Impact Product/Materials" class="col-md-4 col-sm-12 col-form-label">Impact Product/Materials</label>
                                <div class="col-md-6 drp-styles ">
                                    <select formControlName="impactProductOrMaterials" name="status" class="form-select">
                                        <option *ngFor="let selectedImpactDetails of impactDetails" [value]="selectedImpactDetails.code">
                                            {{selectedImpactDetails.name}}
                                        </option>
                                    </select>
                                </div>
                            </div>
                        </ng-container>
                    </div>
                </div>
            <div class="col-md-12">
                    <div class="form-group row">
                        <label for="Procedures Impact " class="col-md-4 col-sm-12 col-form-label">Are any Procedures
                            Impacted </label>

                        <div class="col-lg-6 d-flex radio-styles ">
                            <div class="form-check ">
                                <input class="form-check-input" formControlName="isAnyProceduresImpacted" type="radio" id="yes" name="isAnyProceduresImpacted" value="Yes">
                                <label class="form-check-label" for="yes">Yes</label>
                            </div>
                            <div class="form-check ms-4">
                                <input class="form-check-input" formControlName="isAnyProceduresImpacted" type="radio" id="No" name="isAnyProceduresImpacted" value="No">
                                <label class="form-check-label" for="yes">No</label>
                            </div>
                            <div class="form-check ms-4">
                                <input class="form-check-input" formControlName="isAnyProceduresImpacted" type="radio" id="na" name="isAnyProceduresImpacted" value="Not Applicable">
                                <label class="form-check-label" for="yes">Not Applicable</label>
                            </div>
                        </div>
                    </div>
                <ng-container *ngIf="mainForm.get('impactAssessmentDetails').get('isAnyProceduresImpacted').value == 'Yes'">
                    <div class="col-lg-12">
                        <div class="form-group row">
                            <label for="Impacted Procedures" class="col-md-4 col-sm-12 col-form-label">
                                Impacted Procedures</label>
                            <div class="col-md-6 ">
                                <textarea formControlName="impactedProcedures" class="form-control input-width" name="Impact Procedures"
                                    placeholder="Impacted Procedures">
                                        </textarea>
                            </div>
                        </div>
                    </div>
                </ng-container>
                </div>
            
                <div class="col-lg-12 ">
                    <div class="form-group row">
                        <label for="Comments" class="col-md-4 col-sm-12 col-form-label">Comments</label>
                        <div class="col-md-6 ">
                            <textarea formControlName="comments" class="form-control input-width" name="comment" form="usrform"></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <p-toast></p-toast>
        <div class="d-flex py-2 justify-content-end">
            <button type="button" class="btn btn-default rounded-pill me-3" (click)="backToCCClick()">Cancel</button>
            <button type="button" class="btn btn-outline-primary rounded-pill  me-3" (click)="show()">Save as Draft</button>
            <button type="submit" class="btn btn-primary rounded-pill me-3" (click)="show()">Save</button>
        </div>
    </form>
</div>